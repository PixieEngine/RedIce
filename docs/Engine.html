<!doctype html>
<html>
  <head>
    <meta charset='utf-8' />
    <meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible' />
    <title>Engine</title>
    <link href='/assets/spacedocs/docs.css' media='screen, projection' rel='stylesheet' type='text/css' />
    <script src='http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js' type='text/javascript'></script>
  </head>
  <body>
    <pre></pre>
    <nav>
      <a href='Animated.html'>Animated</a>
      <a href='Array.html'>Array</a>
      <a href='Bindable.html'>Bindable</a>
      <a href='Boolean.html'>Boolean</a>
      <a href='Bounded.html'>Bounded</a>
      <a href='Camera.html'>Camera</a>
      <a href='Collidable.html'>Collidable</a>
      <a href='Collision.html'>Collision</a>
      <a href='Color.html'>Color</a>
      <a href='Core.html'>Core</a>
      <a href='Date.html'>Date</a>
      <a href='Drawable.html'>Drawable</a>
      <a href='Durable.html'>Durable</a>
      <a class='active' href='Engine.html'>Engine</a>
      <a href='Engine.Gamepads.html'>Engine.Gamepads</a>
      <a href='Engine.Joysticks.html'>Engine.Joysticks</a>
      <a href='Fadeable.html'>Fadeable</a>
      <a href='Flickerable.html'>Flickerable</a>
      <a href='Framerate.html'>Framerate</a>
      <a href='Function.html'>Function</a>
      <a href='GameObject.html'>GameObject</a>
      <a href='GameState.html'>GameState</a>
      <a href='Local.html'>Local</a>
      <a href='Math.html'>Math</a>
      <a href='Matrix.html'>Matrix</a>
      <a href='Movable.html'>Movable</a>
      <a href='Music.html'>Music</a>
      <a href='Number.html'>Number</a>
      <a href='Object.html'>Object</a>
      <a href='PixieCanvas.html'>PixieCanvas</a>
      <a href='Point.html'>Point</a>
      <a href='PowerCanvas.html'>PowerCanvas</a>
      <a href='Random.html'>Random</a>
      <a href='RegExp.html'>RegExp</a>
      <a href='ResourceLoader.html'>ResourceLoader</a>
      <a href='Rotatable.html'>Rotatable</a>
      <a href='Sound.html'>Sound</a>
      <a href='Sprite.html'>Sprite</a>
      <a href='String.html'>String</a>
      <a href='jQuery.html'>jQuery</a>
      <a href='justPressed.html'>justPressed</a>
      <a href='keydown.html'>keydown</a>
      <a href='requestAnimationFrame.html'>requestAnimationFrame</a>
      <a href='window.html'>window</a>
    </nav>
    <section class='method_list'>
      <h3>Engine Methods</h3>
      <div class='methods'>
        <a href='Engine.html##add'>#add</a>
        <a href='Engine.html##afterAdd'>#afterAdd</a>
        <a href='Engine.html##afterUpdate'>#afterUpdate</a>
        <a href='Engine.html##beforeAdd'>#beforeAdd</a>
        <a href='Engine.html##beforeDraw'>#beforeDraw</a>
        <a href='Engine.html##cameras'>#cameras</a>
        <a href='Engine.html##collides'>#collides</a>
        <a href='Engine.html##collidesWith'>#collidesWith</a>
        <a href='Engine.html##delay'>#delay</a>
        <a href='Engine.html##draw'>#draw</a>
        <a href='Engine.html##find'>#find</a>
        <a href='Engine.html##frameAdvance'>#frameAdvance</a>
        <a href='Engine.html##loadMap'>#loadMap</a>
        <a href='Engine.html##overlay'>#overlay</a>
        <a href='Engine.html##pause'>#pause</a>
        <a href='Engine.html##paused'>#paused</a>
        <a href='Engine.html##play'>#play</a>
        <a href='Engine.html##rayCollides'>#rayCollides</a>
        <a href='Engine.html##setFramerate'>#setFramerate</a>
        <a href='Engine.html##start'>#start</a>
        <a href='Engine.html##stop'>#stop</a>
        <a href='Engine.html##update'>#update</a>
      </div>
    </section>
    <div class='documentation'>
      <h1>Engine Summary</h1>
      <div class='description'>
        <section class='summary'></section>
        <p>The Engine controls the game world and manages game state. Once you <br />set it up and let it run it pretty much takes care of itself.</p>
        <section class='usage'>
          <h3>Usage</h3>
          <p>You can use the engine to add or remove objects from the game world.</p>
          
          <p>There are several modules that can include to add additional capabilities <br />to the engine.</p>
          
          <p>The engine fires events that you  may bind listeners to. Event listeners <br />may be bound with <code>engine.bind(eventName, callback)</code></p>
        </section>
      </div>
      <hr />
      <a name='#add'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#add(entityData)</h1>
      <div class='description'>
        <section class='summary'><p>The add method creates and adds an object to the game world. Two<br />other events are triggered around this one: beforeAdd and afterAdd.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          <p><code><pre></p>&#x000A;&#x000A;<h1>you can add arbitrary entityData and</h1>&#x000A;&#x000A;<h1>the engine will make it into a GameObject</h1>&#x000A;&#x000A;<p>engine.add <br />  x: 50<br />  y: 30<br />  color: "red"</p>&#x000A;&#x000A;<p>player = engine.add<br />  class: "Player"<br /></pre></code></p>
        </section>
        <section class='parameters'>
          <h3>Parameters</h3>
          <ul>
            <li>
              <span class='param_name'>entityData</span>
               -
              <span class='param_description'>The data used to create the game object.</span>
            </li>
          </ul>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='GameObject.html'>GameObject</a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>add: function(entityData) {&#x000A;      var object;&#x000A;      self.trigger("beforeAdd", entityData);&#x000A;      object = GameObject.construct(entityData);&#x000A;      object.create();&#x000A;      self.trigger("afterAdd", object);&#x000A;      if (I.updating) {&#x000A;        queuedObjects.push(object);&#x000A;      } else {&#x000A;        I.objects.push(object);&#x000A;      }&#x000A;      return object;&#x000A;    },&#x000A;    objects: function() {&#x000A;      return I.objects.copy();&#x000A;    }&#x000A;  });&#x000A;  self.include(Bindable);&#x000A;  self.bind("update", function() {&#x000A;    var toRemove, _ref;&#x000A;    I.updating = true;&#x000A;    _ref = I.objects.partition(function(object) {&#x000A;      return object.update();&#x000A;    }), I.objects = _ref[0], toRemove = _ref[1];&#x000A;    toRemove.invoke("trigger", "remove");&#x000A;    I.updating = false;&#x000A;    I.objects = I.objects.concat(queuedObjects);&#x000A;    return queuedObjects = [];&#x000A;  });&#x000A;  self.include(GameState.Cameras);&#x000A;  self.include(GameState.SaveState);&#x000A;  return self;&#x000A;};&#x000A;;&#x000A;&#x000A;GameState.Cameras = function(I, self) {&#x000A;  var cameras;&#x000A;  cameras = [Camera()];&#x000A;  self.bind('afterUpdate', function() {&#x000A;    return self.cameras().each(function(camera) {&#x000A;      return camera.trigger('afterUpdate');&#x000A;    });&#x000A;  });&#x000A;  self.bind('draw', function(canvas) {&#x000A;    return self.cameras().invoke('trigger', 'draw', canvas, self.objects());&#x000A;  });&#x000A;  self.bind('overlay', function(canvas) {&#x000A;    return self.cameras().each(function(camera) {&#x000A;      return camera.trigger('overlay', canvas);&#x000A;    });&#x000A;  });&#x000A;  return {&#x000A;    addCamera: function(data) {&#x000A;      return cameras.push(Camera(data));&#x000A;    },</code></pre>
        </section>
      </div>
      <hr />
      <a name='#afterAdd'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#afterAdd(object)</h1>
      <div class='description'>
        <section class='summary'><p>Observe or configure a <code>gameObject</code> that has been added <br />to the engine.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          
        </section>
        <section class='parameters'>
          <h3>Parameters</h3>
          <ul>
            <li>
              <span class='param_name'>object</span>
               -
              <span class='param_description'>The object that has just been added to the</span>
            </li>
          </ul>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code></code></pre>
        </section>
      </div>
      <hr />
      <a name='#afterUpdate'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#afterUpdate()</h1>
      <div class='description'>
        <section class='summary'><p>Called after the engine completes an update. Here it is <br />safe to modify the game objects array.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code></code></pre>
        </section>
      </div>
      <hr />
      <a name='#beforeAdd'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#beforeAdd(entityData)</h1>
      <div class='description'>
        <section class='summary'><p>Observe or modify the <br />entity data before it is added to the engine.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          
        </section>
        <section class='parameters'>
          <h3>Parameters</h3>
          <ul>
            <li>
              <span class='param_name'>entityData</span>
               -
              <span class='param_description'></span>
            </li>
          </ul>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code></code></pre>
        </section>
      </div>
      <hr />
      <a name='#beforeDraw'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#beforeDraw()</h1>
      <div class='description'>
        <section class='summary'><p>Called before the engine draws the game objects on the canvas. The current camera transform is applied.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code></code></pre>
        </section>
      </div>
      <hr />
      <a name='#cameras'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#cameras()</h1>
      <div class='description'>
        <section class='summary'><p>Returns the array of camera objects.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='Array.html'>Array</a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>cameras: function(newCameras) {&#x000A;      if (newCameras) {&#x000A;        cameras = newCameras;&#x000A;        return self;&#x000A;      } else {&#x000A;        return cameras;&#x000A;      }&#x000A;    }&#x000A;  };&#x000A;};&#x000A;;</code></pre>
        </section>
      </div>
      <hr />
      <a name='#collides'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#collides(The, An)</h1>
      <div class='description'>
        <section class='summary'><p>Detects collisions between a bounds and the game objects.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          
        </section>
        <section class='parameters'>
          <h3>Parameters</h3>
          <ul>
            <li>
              <span class='param_name'>The</span>
               -
              <span class='param_description'>bounds to check collisions with.</span>
            </li>
            <li>
              <span class='param_name'>An</span>
               -
              <span class='param_description'>object to exclude from the results.</span>
            </li>
          </ul>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='Boolean.html'>Boolean</a>
          </p>
          <p class='return_description'>true if the bounds object collides with any of the game objects, false otherwise.</p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>collides: function(bounds, sourceObject) {&#x000A;      return self.objects().inject(false, function(collided, object) {&#x000A;        return collided || (object.solid() && (object !== sourceObject) && object.collides(bounds));&#x000A;      });&#x000A;    },</code></pre>
        </section>
      </div>
      <hr />
      <a name='#collidesWith'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#collidesWith(The, An)</h1>
      <div class='description'>
        <section class='summary'><p>Detects collisions between a bounds and the game objects. <br />Returns an array of objects colliding with the bounds provided.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          
        </section>
        <section class='parameters'>
          <h3>Parameters</h3>
          <ul>
            <li>
              <span class='param_name'>The</span>
               -
              <span class='param_description'>bounds to check collisions with.</span>
            </li>
            <li>
              <span class='param_name'>An</span>
               -
              <span class='param_description'>object to exclude from the results.</span>
            </li>
          </ul>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='Array.html'>Array</a>
          </p>
          <p class='return_description'>An array of objects that collide with the given bounds.</p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>collidesWith: function(bounds, sourceObject) {&#x000A;      var collided;&#x000A;      collided = [];&#x000A;      self.objects().each(function(object) {&#x000A;        if (!object.solid()) return;&#x000A;        if (object !== sourceObject && object.collides(bounds)) {&#x000A;          return collided.push(object);&#x000A;        }&#x000A;      });&#x000A;      if (collided.length) return collided;&#x000A;    },</code></pre>
        </section>
      </div>
      <hr />
      <a name='#delay'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#delay(steps, callback)</h1>
      <div class='description'>
        <section class='summary'><p>Execute a callback after a number of steps have passed.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          <p><code><pre><br />engine.delay 5, -><br />  engine.add<br />    class: "Ghost"<br /></pre></code></p>
        </section>
        <section class='parameters'>
          <h3>Parameters</h3>
          <ul>
            <li>
              <span class='param_name'>steps</span>
               -
              <span class='param_description'>The number of steps to wait before executing the callback</span>
            </li>
            <li>
              <span class='param_name'>callback</span>
               -
              <span class='param_description'>The callback to be executed.</span>
            </li>
          </ul>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='Engine.html'>Engine</a>
          </p>
          <p class='return_description'>self</p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>delay: function(steps, callback) {&#x000A;      delayedEvents.push({&#x000A;        delay: steps,&#x000A;        callback: callback&#x000A;      });&#x000A;      return self;&#x000A;    }&#x000A;  };&#x000A;};&#x000A;;&#x000A;&#x000A;Engine.GameState = function(I, self) {&#x000A;  var requestedState;&#x000A;  Object.reverseMerge(I, {&#x000A;    currentState: GameState()&#x000A;  });&#x000A;  requestedState = null;&#x000A;  self.bind("update", function() {&#x000A;    I.currentState.trigger("beforeUpdate");&#x000A;    I.currentState.trigger("update");&#x000A;    return I.currentState.trigger("afterUpdate");&#x000A;  });&#x000A;  self.bind("afterUpdate", function() {&#x000A;    var previousState;&#x000A;    if (requestedState != null) {&#x000A;      I.currentState.trigger("exit", requestedState);&#x000A;      previousState = I.currentState;&#x000A;      I.currentState = requestedState;&#x000A;      I.currentState.trigger("enter", previousState);&#x000A;      return requestedState = null;&#x000A;    }&#x000A;  });&#x000A;  self.bind("draw", function(canvas) {&#x000A;    I.currentState.trigger("beforeDraw", canvas);&#x000A;    I.currentState.trigger("draw", canvas);&#x000A;    return I.currentState.trigger("overlay", canvas);&#x000A;  });&#x000A;  return {&#x000A;    add: function(entityData) {&#x000A;      var object;&#x000A;      self.trigger("beforeAdd", entityData);&#x000A;      object = I.currentState.add(entityData);&#x000A;      self.trigger("afterAdd", object);&#x000A;      return object;&#x000A;    },&#x000A;    camera: function(n) {&#x000A;      if (n == null) n = 0;&#x000A;      return self.cameras()[n];&#x000A;    },&#x000A;    cameras: function(newCameras) {&#x000A;      if (newCameras != null) {&#x000A;        I.currentState.cameras(newCameras);&#x000A;        return self;&#x000A;      } else {&#x000A;        return I.currentState.cameras();&#x000A;      }&#x000A;    },&#x000A;    flash: function(options) {&#x000A;      if (options == null) options = {};&#x000A;      return self.camera(options.camera).flash(options);&#x000A;    },&#x000A;    objects: function() {&#x000A;      return I.currentState.objects();&#x000A;    },&#x000A;    setState: function(newState) {&#x000A;      return requestedState = newState;&#x000A;    },&#x000A;    shake: function(options) {&#x000A;      if (options == null) options = {};&#x000A;      return self.camera(options.camera).shake(options);&#x000A;    },&#x000A;    saveState: function() {&#x000A;      return I.currentState.saveState();&#x000A;    },&#x000A;    loadState: function(newState) {&#x000A;      return I.currentState.loadState(newState);&#x000A;    },&#x000A;    reload: function() {&#x000A;      return I.currentState.reload();&#x000A;    }&#x000A;  };&#x000A;};&#x000A;;</code></pre>
        </section>
      </div>
      <hr />
      <a name='#draw'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#draw()</h1>
      <div class='description'>
        <section class='summary'><p>Called after the engine draws on the canvas. The current camera transform is applied.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          <p><code><pre><br />engine.bind "draw", (canvas) -><br />  # print some directions for the player<br />  canvas.drawText<br />    text: "Go this way =>"<br />    x: 200<br />    y: 200 <br /></pre></code></p>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code></code></pre>
        </section>
      </div>
      <hr />
      <a name='#find'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#find(selector)</h1>
      <div class='description'>
        <section class='summary'><p>Get a selection of GameObjects that match the specified selector criteria. The selector language<br />can select objects by id, class, or attributes. Note that this method always returns an Array,<br />so if you are trying to find only one object you will need something like <code>engine.find("Enemy").first()</code>.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          <p><code><pre><br />player = engine.add<br />  class: "Player"</p>&#x000A;&#x000A;<p>enemy = engine.add<br />  class: "Enemy"<br />  speed: 5<br />  x: 0</p>&#x000A;&#x000A;<p>distantEnemy = engine.add<br />  class "Enemy"<br />  x: 500</p>&#x000A;&#x000A;<p>boss = engine.add<br />  class: "Enemy"<br />  id: "Boss"<br />  x: 0</p>&#x000A;&#x000A;<h1>to select an object by id use "#anId"</h1>&#x000A;&#x000A;<p>engine.find "#Boss"</p>&#x000A;&#x000A;<h1>=> [boss]</h1>&#x000A;&#x000A;<h1>to select an object by class use "MyClass"</h1>&#x000A;&#x000A;<p>engine.find "Enemy"</p>&#x000A;&#x000A;<h1>=> [enemy, distantEnemy, boss]</h1>&#x000A;&#x000A;<h1>to select an object by properties use ".someProperty" or ".someProperty=someValue"</h1>&#x000A;&#x000A;<p>engine.find ".speed=5"</p>&#x000A;&#x000A;<h1>=> [enemy]</h1>&#x000A;&#x000A;<h1>You may mix and match selectors.</h1>&#x000A;&#x000A;<p>engine.find "Enemy.x=0"</p>&#x000A;&#x000A;<h1>=> [enemy, boss] # doesn't return distantEnemy</h1>&#x000A;&#x000A;<p></pre></code></p>
        </section>
        <section class='parameters'>
          <h3>Parameters</h3>
          <ul>
            <li>
              <span class='param_name'>selector</span>
               -
              <span class='param_description'></span>
            </li>
          </ul>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='Array.html'>Array</a>
          </p>
          <p class='return_description'>An array of the objects found</p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>find: function(selector) {&#x000A;      var matcher, results;&#x000A;      results = [];&#x000A;      matcher = Engine.Selector.generate(selector);&#x000A;      self.objects().each(function(object) {&#x000A;        if (matcher.match(object)) return results.push(object);&#x000A;      });&#x000A;      return Object.extend(results, instanceMethods);&#x000A;    }&#x000A;  };&#x000A;};&#x000A;&#x000A;Object.extend(Engine.Selector, {&#x000A;  parse: function(selector) {&#x000A;    return selector.split(",").invoke("trim");&#x000A;  },&#x000A;  process: function(item) {&#x000A;    var result;&#x000A;    result = /^(\w+)?#?([\w\-]+)?\.?([\w\-]+)?=?([\w\-]+)?/.exec(item);&#x000A;    if (result) {&#x000A;      if (result[4]) result[4] = result[4].parse();&#x000A;      return result.splice(1);&#x000A;    } else {&#x000A;      return [];&#x000A;    }&#x000A;  },&#x000A;  generate: function(selector) {&#x000A;    var ATTR, ATTR_VALUE, ID, TYPE, components;&#x000A;    components = Engine.Selector.parse(selector).map(function(piece) {&#x000A;      return Engine.Selector.process(piece);&#x000A;    });&#x000A;    TYPE = 0;&#x000A;    ID = 1;&#x000A;    ATTR = 2;&#x000A;    ATTR_VALUE = 3;&#x000A;    return {&#x000A;      match: function(object) {&#x000A;        var attr, attrMatch, component, idMatch, typeMatch, value, _i, _len;&#x000A;        for (_i = 0, _len = components.length; _i < _len; _i++) {&#x000A;          component = components[_i];&#x000A;          idMatch = (component[ID] === object.I.id) || !component[ID];&#x000A;          typeMatch = (component[TYPE] === object.I["class"]) || !component[TYPE];&#x000A;          if (attr = component[ATTR]) {&#x000A;            if ((value = component[ATTR_VALUE]) != null) {&#x000A;              attrMatch = object.I[attr] === value;&#x000A;            } else {&#x000A;              attrMatch = object.I[attr];&#x000A;            }&#x000A;          } else {&#x000A;            attrMatch = true;&#x000A;          }&#x000A;          if (idMatch && typeMatch && attrMatch) return true;&#x000A;        }&#x000A;        return false;&#x000A;      }&#x000A;    };&#x000A;  }&#x000A;});&#x000A;;</code></pre>
        </section>
      </div>
      <hr />
      <a name='#frameAdvance'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#frameAdvance()</h1>
      <div class='description'>
        <section class='summary'><p>Pause the game and step through 1 update of the engine.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          <p><code><pre><br />engine.frameAdvance()<br /></pre></code></p>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>frameAdvance: function() {&#x000A;        I.paused = true;&#x000A;        frameAdvance = true;&#x000A;        step();&#x000A;        return frameAdvance = false;&#x000A;      },</code></pre>
        </section>
      </div>
      <hr />
      <a name='#loadMap'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#loadMap()</h1>
      <div class='description'>
        <section class='summary'><p>Loads a new may and unloads any existing map or entities.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>loadMap: function(name, complete) {&#x000A;      clearObjects = updating;&#x000A;      return map = Tilemap.load({&#x000A;        name: name,&#x000A;        complete: complete,&#x000A;        entity: self.add&#x000A;      });&#x000A;    }&#x000A;  };&#x000A;};;</code></pre>
        </section>
      </div>
      <hr />
      <a name='#overlay'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#overlay()</h1>
      <div class='description'>
        <section class='summary'><p>Called after the engine draws.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          <p>The current camera transform is not applied. This is great for<br />adding overlays.</p>&#x000A;&#x000A;<p><code><pre><br />engine.bind "overlay", (canvas) -><br />  # print the player's health. This will be<br />  # positioned absolutely according to the viewport.<br />  canvas.drawText<br />    text: "HEALTH:"<br />    position: Point(20, 20)</p>&#x000A;&#x000A;<p>canvas.drawText<br />    text: player.health()<br />    position: Point(50, 20)<br /></pre></code></p>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>Engine = function(I) {&#x000A;    var animLoop, defaultModules, draw, frameAdvance, lastStepTime, modules, running, self, startTime, step, update;&#x000A;    if (I == null) I = {};&#x000A;    Object.reverseMerge(I, defaults);&#x000A;    frameAdvance = false;&#x000A;    running = false;&#x000A;    startTime = +new Date();&#x000A;    lastStepTime = -Infinity;&#x000A;    animLoop = function(timestamp) {&#x000A;      var delta, msPerFrame, remainder;&#x000A;      timestamp || (timestamp = +new Date());&#x000A;      msPerFrame = 1000 / I.FPS;&#x000A;      delta = timestamp - lastStepTime;&#x000A;      remainder = delta - msPerFrame;&#x000A;      if (remainder > 0) {&#x000A;        lastStepTime = timestamp - Math.min(remainder, msPerFrame);&#x000A;        step();&#x000A;      }&#x000A;      if (running) return window.requestAnimationFrame(animLoop);&#x000A;    };&#x000A;    update = function() {&#x000A;      self.trigger("beforeUpdate");&#x000A;      self.trigger("update");&#x000A;      return self.trigger("afterUpdate");&#x000A;    };&#x000A;    draw = function() {&#x000A;      var canvas;&#x000A;      if (!(canvas = I.canvas)) return;&#x000A;      self.trigger("beforeDraw", canvas);&#x000A;      self.trigger("draw", canvas);&#x000A;      return self.trigger("overlay", I.canvas);&#x000A;    };&#x000A;    step = function() {&#x000A;      if (!I.paused || frameAdvance) {&#x000A;        update();&#x000A;        I.age += 1;&#x000A;      }&#x000A;      return draw();&#x000A;    };&#x000A;    self = Core(I).extend({</code></pre>
        </section>
      </div>
      <hr />
      <a name='#pause'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#pause(setTo)</h1>
      <div class='description'>
        <section class='summary'><p>Toggle the paused state of the simulation.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          <p><code><pre><br />engine.pause()<br /></pre></code></p>
        </section>
        <section class='parameters'>
          <h3>Parameters</h3>
          <ul>
            <li>
              <span class='param_name'>setTo</span>
               -
              <span class='param_description'>Force to pause by passing true or unpause by passing false.</span>
            </li>
          </ul>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>pause: function(setTo) {&#x000A;        if (setTo != null) {&#x000A;          return I.paused = setTo;&#x000A;        } else {&#x000A;          return I.paused = !I.paused;&#x000A;        }&#x000A;      },</code></pre>
        </section>
      </div>
      <hr />
      <a name='#paused'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#paused()</h1>
      <div class='description'>
        <section class='summary'><p>Query the engine to see if it is paused.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          <p><code><pre><br />engine.pause()</p>&#x000A;&#x000A;<p>engine.paused()</p>&#x000A;&#x000A;<h1>true</h1>&#x000A;&#x000A;<p>engine.play()</p>&#x000A;&#x000A;<p>engine.paused()</p>&#x000A;&#x000A;<h1>false</h1>&#x000A;&#x000A;<p></pre></code></p>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>paused: function() {&#x000A;        return I.paused;&#x000A;      },</code></pre>
        </section>
      </div>
      <hr />
      <a name='#play'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#play()</h1>
      <div class='description'>
        <section class='summary'><p>Resume the game.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          <p><code><pre><br />engine.play()<br /></pre></code></p>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>play: function() {&#x000A;        return I.paused = false;&#x000A;      },</code></pre>
        </section>
      </div>
      <hr />
      <a name='#rayCollides'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#rayCollides(The, A, An)</h1>
      <div class='description'>
        <section class='summary'><p>Detects collisions between a ray and the game objects.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          
        </section>
        <section class='parameters'>
          <h3>Parameters</h3>
          <ul>
            <li>
              <span class='param_name'>The</span>
               -
              <span class='param_description'>origin point</span>
            </li>
            <li>
              <span class='param_name'>A</span>
               -
              <span class='param_description'>point representing the direction of the ray</span>
            </li>
            <li>
              <span class='param_name'>An</span>
               -
              <span class='param_description'>object to exclude from the results.</span>
            </li>
          </ul>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>rayCollides: function(source, direction, sourceObject) {&#x000A;      var hits, nearestDistance, nearestHit;&#x000A;      hits = self.objects().map(function(object) {&#x000A;        var hit;&#x000A;        hit = object.solid() && (object !== sourceObject) && Collision.rayRectangle(source, direction, object.centeredBounds());&#x000A;        if (hit) hit.object = object;&#x000A;        return hit;&#x000A;      });&#x000A;      nearestDistance = Infinity;&#x000A;      nearestHit = null;&#x000A;      hits.each(function(hit) {&#x000A;        var d;&#x000A;        if (hit && (d = hit.distance(source)) < nearestDistance) {&#x000A;          nearestDistance = d;&#x000A;          return nearestHit = hit;&#x000A;        }&#x000A;      });&#x000A;      return nearestHit;&#x000A;    }&#x000A;  };&#x000A;};&#x000A;;</code></pre>
        </section>
      </div>
      <hr />
      <a name='#setFramerate'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#setFramerate()</h1>
      <div class='description'>
        <section class='summary'><p>Change the framerate of the game. The default framerate is 30 fps.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          <p><code><pre><br />engine.setFramerate(60)<br /></pre></code></p>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>setFramerate: function(newFPS) {&#x000A;        I.FPS = newFPS;&#x000A;        self.stop();&#x000A;        return self.start();&#x000A;      },&#x000A;      update: update,&#x000A;      draw: draw&#x000A;    });&#x000A;    self.include(Bindable);&#x000A;    defaultModules = ["Keyboard", "Clear", "Delay", "GameState", "Selector", "Collision"];&#x000A;    modules = defaultModules.concat(I.includedModules);&#x000A;    modules = modules.without([].concat(I.excludedModules));&#x000A;    modules.each(function(moduleName) {&#x000A;      if (!Engine[moduleName]) {&#x000A;        throw "#Engine." + moduleName + " is not a valid engine module";&#x000A;      }&#x000A;      return self.include(Engine[moduleName]);&#x000A;    });&#x000A;    self.trigger("init");&#x000A;    return self;&#x000A;  };&#x000A;  oldEngine = (typeof exports !== "undefined" && exports !== null ? exports : this).Engine;&#x000A;  Object.extend(Engine, oldEngine);&#x000A;  return (typeof exports !== "undefined" && exports !== null ? exports : this)["Engine"] = Engine;&#x000A;})();</code></pre>
        </section>
      </div>
      <hr />
      <a name='#start'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#start()</h1>
      <div class='description'>
        <section class='summary'><p>Start the game simulation.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          <p><code><pre><br />engine.start()<br /></pre></code></p>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>start: function() {&#x000A;        if (!running) {&#x000A;          running = true;&#x000A;          return window.requestAnimationFrame(animLoop);&#x000A;        }&#x000A;      },</code></pre>
        </section>
      </div>
      <hr />
      <a name='#stop'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#stop()</h1>
      <div class='description'>
        <section class='summary'><p>Stop the simulation.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          <p><code><pre><br />engine.stop()<br /></pre></code></p>
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code>stop: function() {&#x000A;        return running = false;&#x000A;      },</code></pre>
        </section>
      </div>
      <hr />
      <a name='#update'></a>
      <!-- TODO make sure method_data isn't nil -->
      <h1>Engine#update()</h1>
      <div class='description'>
        <section class='summary'><p>Called when the engine updates all the game objects.</p></section>
        <section class='usage'>
          <h3>Usage</h3>
          
        </section>
        <section class='returns'>
          <h3>Returns</h3>
          <p>
            Type:
            <a href='.html'></a>
          </p>
          <p class='return_description'></p>
        </section>
        <section class='source'>
          <h3>Source</h3>
          <a class='toggle_source'>Toggle</a>
          <pre><code></code></pre>
        </section>
      </div>
      <hr />
    </div>
  </body>
</html>
<script type='text/javascript'>
  //<![CDATA[
    $(function() {
      $(".documentation").on("click", ".toggle_source", function(e) {
        e.preventDefault();
        return $(this).next().toggle();
      });
      return $("code.run").each(function() {
        var canvas, codeElement, compiledJs, source;
        codeElement = $(this);
        source = codeElement.text();
        compiledJs = CoffeeScript.compile(source, {
          bare: true
        });
        canvas = $("<canvas width=200 height=150/>").pixieCanvas();
        codeElement.after(canvas);
        return eval(compiledJs);
      });
    });
  //]]>
</script>
